{"id":"l15e88e5a4d3a47ac819e1db","name":"spark_people","platform":"bi","inputs":[{"dsId":"ic64e3a2a907a4db2a29b030","name":"spark stargazers","fields":[{"name":"id","type":"STRING","seqNo":0},{"name":"name","type":"STRING","seqNo":1},{"name":"nameWithOwner","type":"STRING","seqNo":2},{"name":"isFork","type":"STRING","seqNo":3},{"name":"isArchived","type":"STRING","seqNo":4},{"name":"isDisabled","type":"STRING","seqNo":5},{"name":"forkCount","type":"STRING","seqNo":6},{"name":"stargazerCount","type":"STRING","seqNo":7},{"name":"diskUsage","type":"STRING","seqNo":8},{"name":"description","type":"STRING","seqNo":9},{"name":"starredAt","type":"STRING","seqNo":10},{"name":"licenseKey","type":"STRING","seqNo":11},{"name":"starredBy","type":"STRING","seqNo":12},{"name":"sparkRelated","type":"BOOL","seqNo":13},{"name":"starredAtTs","type":"TIMESTAMP","seqNo":14}]},{"dsId":"c9333ff3ef79440ada67c3d8","name":"dolphinscheduler stargazer's repos_etl","fields":[{"name":"id","type":"STRING","seqNo":0},{"name":"name","type":"STRING","seqNo":1},{"name":"nameWithOwner","type":"STRING","seqNo":2},{"name":"isFork","type":"STRING","seqNo":3},{"name":"isArchived","type":"STRING","seqNo":4},{"name":"isDisabled","type":"STRING","seqNo":5},{"name":"forkCount","type":"LONG","seqNo":6},{"name":"stargazerCount","type":"LONG","seqNo":7},{"name":"diskUsage","type":"LONG","seqNo":8},{"name":"description","type":"STRING","seqNo":9},{"name":"starredAt","type":"TIMESTAMP","seqNo":10},{"name":"licenseKey","type":"STRING","seqNo":11},{"name":"starredBy","type":"STRING","seqNo":12}]}],"outputs":[{"dsId":"e63b16fa62f7f4d1c80bb9a6","name":"test_output"}],"meta":[{"type":"SQL_SCRIPT","sql":"SELECT * from input1 order by id asc","name":"SQL输入","id":"id_1667570741476","position":{"x":1260,"y":130},"sqlStatus":"valid","sources":["id_1667570672641"]},{"type":"INPUT_DATASET","name":"spark stargazers","displayType":"DATAFLOW","preview":{"scope":"ALL","config":{}},"cascadeUpdateEnabled":false,"inputDsId":"ic64e3a2a907a4db2a29b030","id":"id_1614234445981","position":{"x":200,"y":40},"sources":[]},{"type":"APPEND_ROWS","name":"行拼接","id":"id_1667570614439","position":{"x":1050,"y":200},"dataFusion":{"dataSources":[{"key":"id_1667569842658"},{"key":"id_1667570626174"}],"fusionType":"ROW","unionType":"INCLUDE_ALL","schemaSource":""},"sources":["id_1667569842658","id_1667570626174"]},{"type":"JOIN_DATA","name":"关联数据","id":"id_1667570672641","position":{"x":1170,"y":130},"dataFusion":{"dataSources":[{"key":"id_1667570614439"},{"key":"id_1667569868940"}],"fusionType":"COLUMN","columnFuses":[{"leftKey":"id_1667570614439","rightKey":"id_1667569868940","joinType":"INNER","predicates":[{"leftColumn":"name","rightColumn":"name"}]}],"selectedColumns":[{"name":"combined_name","dsKey":"id_1667570614439","isIgnored":false},{"name":"name","dsKey":"id_1667570614439","isIgnored":false},{"name":"licenseKey","dsKey":"id_1667570614439","isIgnored":false},{"name":"forkCount","dsKey":"id_1667570614439","isIgnored":false},{"name":"diskUsage","dsKey":"id_1667570614439","isIgnored":false},{"name":"new1","dsKey":"id_1667570614439","isIgnored":false},{"name":"value2","dsKey":"id_1667570614439","isIgnored":false},{"name":"id","dsKey":"id_1667570614439","isIgnored":false},{"name":"nameWithOwner","dsKey":"id_1667570614439","isIgnored":false},{"name":"isFork","dsKey":"id_1667570614439","isIgnored":false},{"name":"isArchived","dsKey":"id_1667570614439","isIgnored":false},{"name":"isDisabled","dsKey":"id_1667570614439","isIgnored":false},{"name":"stargazerCount","dsKey":"id_1667570614439","isIgnored":false},{"name":"description","dsKey":"id_1667570614439","isIgnored":false},{"name":"starredAt","dsKey":"id_1667570614439","isIgnored":false},{"name":"starredBy","dsKey":"id_1667570614439","isIgnored":false},{"name":"id","dsKey":"id_1667569868940","isIgnored":true},{"name":"name","dsKey":"id_1667569868940","isIgnored":true},{"name":"nameWithOwner","dsKey":"id_1667569868940","isIgnored":true},{"name":"isFork","dsKey":"id_1667569868940","isIgnored":true},{"name":"isArchived","dsKey":"id_1667569868940","isIgnored":true},{"name":"isDisabled","dsKey":"id_1667569868940","isIgnored":true},{"name":"forkCount","dsKey":"id_1667569868940","isIgnored":true},{"name":"stargazerCount","dsKey":"id_1667569868940","isIgnored":true},{"name":"diskUsage","dsKey":"id_1667569868940","isIgnored":true},{"name":"description","dsKey":"id_1667569868940","isIgnored":true},{"name":"starredAt","dsKey":"id_1667569868940","isIgnored":true},{"name":"starredAtTs","dsKey":"id_1667569868940","isIgnored":false},{"name":"is_licensed","dsKey":"id_1667569868940","isIgnored":false},{"name":"is_licensed_2","dsKey":"id_1667569868940","isIgnored":false},{"name":"is_licensed_combined","dsKey":"id_1667569868940","isIgnored":false}]},"sources":["id_1667570614439","id_1667569868940"]},{"type":"CALCULATOR","name":"添加计算列","id":"id_1667568974572","formulas":[{"name":"is_licensed","type":"BOOL","expr":"case when length([licenseKey]) > 0 then 'licensed' else 'not licensed' end","key":"OfUQdTHeQH"},{"name":"is_licensed_2","type":"BOOL","expr":"case when length([licenseKey]) > 1 then 'licensed2' else 'not licensed2' end","key":"kMSUCXMjMR"}],"position":{"x":350,"y":40},"sources":["id_1614234445981"]},{"type":"UNCOLLAPSE_COLUMNS","aggrColumn":"forkCount","name":"行转列","aggrType":"NUL","id":"id_1667569379285","sameAsOld":true,"groupBy":["name","combined_name","licenseKey","diskUsage","forkCount"],"fields":[{"targetName":"True","keyValue":"True","key":"RefkRvbgiP"},{"targetName":"False","keyValue":"False","key":"zpRPduIsOu"}],"position":{"x":500,"y":160},"column":"isFork","sources":["id_1667569282337"]},{"type":"SINGLE_VALUE_MAPPER","mappings":[{"colName":"isDisabled","toValue":"111"},{"colName":"starredAtTs","toValue":"222"}],"name":"Null值替换","id":"id_1667569868940","position":{"x":950,"y":40},"sources":["id_1667569772841"]},{"type":"REMOVE_DUPLICATES","name":"去重","columnNames":["name"],"id":"id_1667569827207","position":{"x":800,"y":160},"sources":["id_1667569691366"]},{"type":"FILTER_ROWS","conditions":[{"name":"isFork","filterType":"EQ","fdType":"STRING","filterValue":[{"v":"False","type":"VALUE"}]},{"name":"is_licensed","filterType":"EQ","fdType":"BOOL","filterValue":[{"v":"true","type":"VALUE"}]}],"name":"筛选数据行","combineType":"OR","id":"id_1667569772841","position":{"x":800,"y":40},"sources":["id_1667569353379"]},{"type":"VALUE_MAPPER","mappings":[{"from":"T1","to":"T2"},{"from":"T3","to":"T4"}],"name":"值替换","id":"id_1667569842658","position":{"x":950,"y":160},"column":"licenseKey","defaultValue":{"value":null,"fromColumn":"licenseKey"},"sources":["id_1667569827207"]},{"type":"SELECT_COLUMNS","name":"选择列","id":"id_1667569353379","columns":[{"name":"id","dsKey":"id_1667569067869","isIgnored":false},{"name":"name","dsKey":"id_1667569067869","isIgnored":false},{"name":"nameWithOwner","dsKey":"id_1667569067869","isIgnored":false},{"name":"isFork","dsKey":"id_1667569067869","isIgnored":false},{"name":"isArchived","dsKey":"id_1667569067869","isIgnored":false},{"name":"isDisabled","dsKey":"id_1667569067869","isIgnored":false},{"name":"forkCount","dsKey":"id_1667569067869","isIgnored":false},{"name":"stargazerCount","dsKey":"id_1667569067869","isIgnored":false},{"name":"diskUsage","dsKey":"id_1667569067869","isIgnored":false},{"name":"description","dsKey":"id_1667569067869","isIgnored":false},{"name":"starredAt","dsKey":"id_1667569067869","isIgnored":false},{"name":"starredAtTs","dsKey":"id_1667569067869","isIgnored":false},{"name":"is_licensed","dsKey":"id_1667569067869","isIgnored":false},{"name":"is_licensed_2","dsKey":"id_1667569067869","isIgnored":false},{"name":"is_licensed_combined","dsKey":"id_1667569067869","isIgnored":false}],"position":{"x":650,"y":40},"sources":["id_1667569067869"]},{"type":"COLLAPSE_COLUMNS","name":"列转行","metricName":"value2","dimName":"new1","id":"id_1667569691366","columns":[{"name":"True","newName":"True"},{"name":"False","newName":"False"}],"position":{"x":650,"y":160},"sources":["id_1667569379285"]},{"type":"INPUT_DATASET","name":"dolphinscheduler stargazer's repos_etl","displayType":"DATAFLOW","preview":{"scope":"ALL","config":{}},"cascadeUpdateEnabled":false,"inputDsId":"c9333ff3ef79440ada67c3d8","id":"id_1667569263588","position":{"x":200,"y":160},"sources":[]},{"type":"INPUT_DATASET","name":"dolphinscheduler stargazer's repos_etl","displayType":"DATAFLOW","preview":{"scope":"ALL","config":{}},"cascadeUpdateEnabled":false,"inputDsId":"c9333ff3ef79440ada67c3d8","id":"id_1667570626174","position":{"x":770,"y":310},"sources":[]},{"type":"COMBINE_COLUMNS","name":"合并列","separator":";","targetFieldName":"is_licensed_combined","id":"id_1667569067869","fields":["is_licensed","is_licensed_2"],"position":{"x":500,"y":40},"sources":["id_1667568974572"],"removeSelectedFields":false},{"type":"GROUP_BY","name":"分组聚合","newMetric":[],"id":"id_1667569282337","zoneData":{"row":[{"fdId":"c79b4597bb33b471e9eebc96","name":"combined_name","fdType":"STRING","metaType":"DIM","formula":"concat([name],[nameWithOwner])","isAggregated":false,"calculationType":"normal","key":"wREgEnzFWC"},{"fdId":"abf8441d2cd384f9fb1c6902","name":"name","fdType":"STRING","metaType":"DIM","key":"EfuyFswnjG"},{"fdId":"d7b96f68b9fc84caabf257c4","name":"licenseKey","fdType":"STRING","metaType":"DIM","key":"oAJspFNwXT"},{"fdId":"n9e5b7e65cb44487ea8feacd","name":"isFork","fdType":"STRING","metaType":"DIM","key":"OzFTcGioQw"}],"metric":[{"fdId":"jfaf1c3b753804760a87c1d4","name":"forkCount","fdType":"LONG","metaType":"METRIC","aggrType":"SUM","key":"HieSIePgod"},{"fdId":"n4ac1ebf5c3ce4e7b89436a6","name":"stargazerCount","fdType":"LONG","metaType":"METRIC","aggrType":"SUM","key":"vNXfxHRWxr"},{"fdId":"c221a60cde19c442b9b283b3","name":"diskUsage","fdType":"LONG","metaType":"METRIC","aggrType":"SUM","key":"mfzjaxbZln"}]},"position":{"x":350,"y":160},"sources":["id_1667569263588"],"newDim":[{"fdId":"c79b4597bb33b471e9eebc96","name":"combined_name","fdType":"STRING","metaType":"DIM","formula":"concat([name],[nameWithOwner])","isAggregated":false,"calculationType":"normal"}]},{"type":"OUTPUT_DATASET","name":"test_output","parentDirId":"h1a813d864a584ec9a7b8a36","dataSource":{"parentDirId":"h1a813d864a584ec9a7b8a36","parentDirName":"根目录","dirPath":[{"dirId":"h1a813d864a584ec9a7b8a36","dirName":"根目录"}],"name":"test_output","dsId":"e63b16fa62f7f4d1c80bb9a6"},"id":"id_1667570761842","position":{"x":1340,"y":140},"outputDsName":"test_output","sources":["id_1667570741476"]}],"annotation":{"list":[],"hidden":false},"description":null}